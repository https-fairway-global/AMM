Compact runtime API
@midnight-ntwrk/compact-runtime v0.7.0 • Readme | API

Compact runtime library
This API provides runtime primitives used by Compact's TypeScript output, both for use by the compiler output directly, and to utilise it or reproduce its behaviour. This API re-exports a number of items from @midnight-ntwrk/onchain-runtime, and wraps others in a more TypeScript-friendly API. Key parts of the API are:

setNetworkId, required to ensure the right network is being targeted
CircuitContext, and CircuitResults part of the input and output definition of all circuits
WitnessContext, part of the input definition of all circuits
Built-in functions:
Hashing/commitment
transientHash
transientCommit
persistentHash
persistentCommit
degradeToTransient
Elliptic curve
ecAdd
ecMul
ecMulGenerator
hashToCurve
ContractState, encapsulating the entirety of a smart contract's on-chain state
StateValue, encoding data a contract maintains on-chain
QueryContext, providing an annotated view into the contract state, against which on-chain VM programs can be run
CompactType, providing a runtime representation of basic Compact datatypes
Various TypeScript types matching same-named Compact types

## Classes

@midnight-ntwrk/compact-runtime v0.7.0 / CompactError

Class: CompactError
An error originating from code generated by the Compact compiler

Extends
Error
Constructors
new CompactError(msg)
new CompactError(msg): CompactError

Parameters
• msg: string

Returns
CompactError

Overrides
Error.constructor

Properties
message
message: string;

Inherited from
Error.message

name
name: string;

Inherited from
Error.name

stack?
optional stack: string;

Inherited from
Error.stack

prepareStackTrace?
static optional prepareStackTrace: (err, stackTraces) => any;

Optional override for formatting stack traces

Parameters
• err: Error

• stackTraces: CallSite[]

Returns
any

See
https://v8.dev/docs/stack-trace-api#customizing-stack-traces

Inherited from
Error.prepareStackTrace

stackTraceLimit
static stackTraceLimit: number;

Inherited from
Error.stackTraceLimit

Methods
captureStackTrace()
static captureStackTrace(targetObject, constructorOpt?): void

Create .stack property on a target object

Parameters
• targetObject: object

• constructorOpt?: Function

Returns
void

Inherited from
Error.captureStackTrace


Class: CompactTypeBoolean
Runtime type of the builtin Boolean type

Implements
CompactType<boolean>
Constructors
new CompactTypeBoolean()
new CompactTypeBoolean(): CompactTypeBoolean

Returns
CompactTypeBoolean

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): boolean

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
boolean

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: boolean

Returns
Value

Implementation of
CompactType.toValue


Class: CompactTypeBytes
Runtime type of the builtin Bytes types

Implements
CompactType<Uint8Array>
Constructors
new CompactTypeBytes(length)
new CompactTypeBytes(length): CompactTypeBytes

Parameters
• length: number

Returns
CompactTypeBytes

Properties
length
readonly length: number;

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): Uint8Array

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
Uint8Array

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: Uint8Array

Returns
Value

Implementation of
CompactType.toValue


Class: CompactTypeCurvePoint
Runtime type of CurvePoint

Implements
CompactType<CurvePoint>
Constructors
new CompactTypeCurvePoint()
new CompactTypeCurvePoint(): CompactTypeCurvePoint

Returns
CompactTypeCurvePoint

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): CurvePoint

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
CurvePoint

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: CurvePoint

Returns
Value

Implementation of
CompactType.toValue


Class: CompactTypeEnum
Runtime type of an enum with a given number of entries

Implements
CompactType<number>
Constructors
new CompactTypeEnum(maxValue, length)
new CompactTypeEnum(maxValue, length): CompactTypeEnum

Parameters
• maxValue: number

• length: number

Returns
CompactTypeEnum

Properties
length
readonly length: number;

maxValue
readonly maxValue: number;

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): number

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
number

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: number

Returns
Value

Implementation of
CompactType.toValue


Class: CompactTypeField
Runtime type of the builtin Field type

Implements
CompactType<bigint>
Constructors
new CompactTypeField()
new CompactTypeField(): CompactTypeField

Returns
CompactTypeField

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): bigint

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
bigint

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: bigint

Returns
Value

Implementation of
CompactType.toValue

Class: CompactTypeMerkleTreeDigest
Runtime type of MerkleTreeDigest

Implements
CompactType<MerkleTreeDigest>
Constructors
new CompactTypeMerkleTreeDigest()
new CompactTypeMerkleTreeDigest(): CompactTypeMerkleTreeDigest

Returns
CompactTypeMerkleTreeDigest

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): MerkleTreeDigest

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
MerkleTreeDigest

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: MerkleTreeDigest

Returns
Value

Implementation of
CompactType.toValue

Class: CompactTypeMerkleTreePath<a>
Runtime type of MerkleTreePath

Type parameters
• a

Implements
CompactType<MerkleTreePath<a>>
Constructors
new CompactTypeMerkleTreePath(n, leaf)
new CompactTypeMerkleTreePath<a>(n, leaf): CompactTypeMerkleTreePath<a>

Parameters
• n: number

• leaf: CompactType<a>

Returns
CompactTypeMerkleTreePath<a>

Properties
leaf
readonly leaf: CompactType<a>;

path
readonly path: CompactTypeVector<MerkleTreePathEntry>;

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): MerkleTreePath<a>

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
MerkleTreePath<a>

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: MerkleTreePath<a>

Returns
Value

Implementation of
CompactType.toValue

Class: CompactTypeMerkleTreePathEntry
Runtime type of MerkleTreePathEntry

Implements
CompactType<MerkleTreePathEntry>
Constructors
new CompactTypeMerkleTreePathEntry()
new CompactTypeMerkleTreePathEntry(): CompactTypeMerkleTreePathEntry

Returns
CompactTypeMerkleTreePathEntry

Properties
bool
readonly bool: CompactTypeBoolean;

digest
readonly digest: CompactTypeMerkleTreeDigest;

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): MerkleTreePathEntry

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
MerkleTreePathEntry

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: MerkleTreePathEntry

Returns
Value

Implementation of
CompactType.toValue

Class: CompactTypeOpaqueString
Runtime type of Opaque["string"]

Implements
CompactType<string>
Constructors
new CompactTypeOpaqueString()
new CompactTypeOpaqueString(): CompactTypeOpaqueString

Returns
CompactTypeOpaqueString

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): string

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
string

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: string

Returns
Value

Implementation of
CompactType.toValue

Class: CompactTypeOpaqueUint8Array
Runtime type of Opaque["Uint8Array"]

Implements
CompactType<Uint8Array>
Constructors
new CompactTypeOpaqueUint8Array()
new CompactTypeOpaqueUint8Array(): CompactTypeOpaqueUint8Array

Returns
CompactTypeOpaqueUint8Array

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): Uint8Array

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
Uint8Array

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: Uint8Array

Returns
Value

Implementation of
CompactType.toValue

Class: CompactTypeUnsignedInteger
Runtime type of the builtin Unsigned Integer types

Implements
CompactType<bigint>
Constructors
new CompactTypeUnsignedInteger(maxValue, length)
new CompactTypeUnsignedInteger(maxValue, length): CompactTypeUnsignedInteger

Parameters
• maxValue: bigint

• length: number

Returns
CompactTypeUnsignedInteger

Properties
length
readonly length: number;

maxValue
readonly maxValue: bigint;

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): bigint

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
bigint

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: bigint

Returns
Value

Implementation of
CompactType.toValue

Class: CompactTypeVector<a>
Runtime type of the builtin Vector types

Type parameters
• a

Implements
CompactType<a[]>
Constructors
new CompactTypeVector(length, type)
new CompactTypeVector<a>(length, type): CompactTypeVector<a>

Parameters
• length: number

• type: CompactType<a>

Returns
CompactTypeVector<a>

Properties
length
readonly length: number;

type
readonly type: CompactType<a>;

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

Implementation of
CompactType.alignment

fromValue()
fromValue(value): a[]

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
a[]

Implementation of
CompactType.fromValue

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: a[]

Returns
Value

Implementation of
CompactType.toValue

Class: ContractMaintenanceAuthority
A committee permitted to make changes to this contract. If a threshold of the public keys in this committee sign off, they can change the rules of this contract, or recompile it for a new version.

If the threshold is greater than the number of committee members, it is impossible for them to sign anything.

Constructors
new ContractMaintenanceAuthority(committee, threshold, counter)
new ContractMaintenanceAuthority(
   committee, 
   threshold, 
   counter?): ContractMaintenanceAuthority

Constructs a new authority from its components

If not supplied, counter will default to 0n. Values should be non-negative, and at most 2^32 - 1.

At deployment, counter must be 0n, and any subsequent update should set counter to exactly one greater than the current value.

Parameters
• committee: string[]

• threshold: number

• counter?: bigint

Returns
ContractMaintenanceAuthority

Properties
committee
readonly committee: string[];

The committee public keys

counter
readonly counter: bigint;

The replay protection counter

threshold
readonly threshold: number;

How many keys must sign rule changes

Methods
serialize()
serialize(networkid): Uint8Array

Parameters
• networkid: NetworkId

Returns
Uint8Array

toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

deserialize()
static deserialize(raw, networkid): ContractState

Parameters
• raw: Uint8Array

• networkid: NetworkId

Returns
ContractState

Class: ContractOperation
An individual operation, or entry point of a contract, consisting primarily of a ZK verifier keys, potentially for different versions of the proving system.

Only the latest available version is exposed to this API.

Note that the serialized form of the key is checked on initialization

Constructors
new ContractOperation()
new ContractOperation(): ContractOperation

Returns
ContractOperation

Properties
verifierKey
verifierKey: Uint8Array;

Methods
serialize()
serialize(networkid): Uint8Array

Parameters
• networkid: NetworkId

Returns
Uint8Array

toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

deserialize()
static deserialize(raw, networkid): ContractOperation

Parameters
• raw: Uint8Array

• networkid: NetworkId

Returns
ContractOperation

Class: ContractState
The state of a contract, consisting primarily of the data accessible directly to the contract, and the map of ContractOperations that can be called on it, the keys of which can be accessed with operations, and the individual operations can be read with operation and written to with setOperation.

Constructors
new ContractState()
new ContractState(): ContractState

Creates a blank contract state

Returns
ContractState

Properties
data
data: StateValue;

The current value of the primary state of the contract

maintenanceAuthority
maintenanceAuthority: ContractMaintenanceAuthority;

The maintenance authority associated with this contract

Methods
operation()
operation(operation): undefined | ContractOperation

Get the operation at a specific entry point name

Parameters
• operation: string | Uint8Array

Returns
undefined | ContractOperation

operations()
operations(): (string | Uint8Array)[]

Return a list of the entry points currently registered on this contract

Returns
(string | Uint8Array)[]

query()
query(query, cost_model): GatherResult[]

Runs a series of operations against the current state, and returns the results

Parameters
• query: Op<null>[]

• cost_model: CostModel

Returns
GatherResult[]

serialize()
serialize(networkid): Uint8Array

Parameters
• networkid: NetworkId

Returns
Uint8Array

setOperation()
setOperation(operation, value): void

Set a specific entry point name to contain a given operation

Parameters
• operation: string | Uint8Array

• value: ContractOperation

Returns
void

toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

deserialize()
static deserialize(raw, networkid): ContractState

Parameters
• raw: Uint8Array

• networkid: NetworkId

Returns
ContractState

Class: CostModel
A cost model for calculating transaction fees

Constructors
new CostModel()
private new CostModel(): CostModel

Returns
CostModel

Methods
toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

dummyCostModel()
static dummyCostModel(): CostModel

A cost model for use in non-critical contexts

Returns
CostModel

Class: QueryContext
Provides the information needed to fully process a transaction, including information about the rest of the transaction, and the state of the chain at the time of execution.

Constructors
new QueryContext(state, address)
new QueryContext(state, address): QueryContext

Construct a basic context from a contract's address and current state value

Parameters
• state: StateValue

• address: string

Returns
QueryContext

Properties
address
readonly address: string;

The address of the contract

block
block: BlockContext;

The block-level information accessible to the contract

comIndicies
readonly comIndicies: Map<string, bigint>;

The commitment indices map accessible to the contract, primarily via qualify

effects
effects: Effects;

The effects that occurred during execution against this context, should match those declared in a Transcript

state
readonly state: StateValue;

The current contract state retained in the context

Methods
insertCommitment()
insertCommitment(comm, index): QueryContext

Register a given coin commitment as being accessible at a specific index, for use when receiving coins in-contract, and needing to record their index to later spend them

Parameters
• comm: string

• index: bigint

Returns
QueryContext

intoTranscript()
intoTranscript(program, cost_model): [undefined | Transcript<AlignedValue>, undefined | Transcript<AlignedValue>]


Finalizes a sequence of operations against their initial context, resulting in a guaranteed and fallible Transcript, optimally allocated, and heuristically covered for gas fees.

Parameters
• program: Op<AlignedValue>[]

• cost_model: CostModel

Returns
[undefined | Transcript<AlignedValue>, undefined | Transcript<AlignedValue>]

Deprecated
Please use the ledger's partitionTranscripts instead.

qualify()
Internal

qualify(coin): undefined | Value

Internal counterpart to insertCommitment; upgrades an encoded CoinInfo to an encoded QualifiedCoinInfo using the inserted commitments

Parameters
• coin: Value

Returns
undefined | Value

query()
query(
   ops, 
   cost_model, 
   gas_limit?): QueryResults

Runs a sequence of operations in gather mode, returning the results of the gather.

Parameters
• ops: Op<null>[]

• cost_model: CostModel

• gas_limit?: bigint

Returns
QueryResults

runTranscript()
runTranscript(transcript, cost_model): QueryContext

Runs a transcript in verifying mode against the current query context, outputting a new query context, with the state and effects from after the execution.

Parameters
• transcript: Transcript<AlignedValue>

• cost_model: CostModel

Returns
QueryContext

toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

Class: QueryResults
The results of making a query against a specific state or context

Constructors
new QueryResults()
private new QueryResults(): QueryResults

Returns
QueryResults

Properties
context
readonly context: QueryContext;

The context state after executing the query. This can be used to execute further queries

events
readonly events: GatherResult[];

Any events/results that occurred during or from the query

gasCost
readonly gasCost: bigint;

The measured cost of executing the query

Methods
toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

Class: StateBoundedMerkleTree
Represents a fixed-depth Merkle tree storing hashed data, whose preimages are unknown

Constructors
new StateBoundedMerkleTree(height)
new StateBoundedMerkleTree(height): StateBoundedMerkleTree

Create a blank tree with the given height

Parameters
• height: number

Returns
StateBoundedMerkleTree

Properties
height
readonly height: number;

Methods
collapse()
Internal

collapse(start, end): StateBoundedMerkleTree

Erases all but necessary hashes between, and inclusive of, start and end inidices

Parameters
• start: bigint

• end: bigint

Returns
StateBoundedMerkleTree

Throws
If the indices are out-of-bounds for the tree, or end < start

findPathForLeaf()
Internal

findPathForLeaf(leaf): AlignedValue

Internal implementation of the finding path primitive

Parameters
• leaf: AlignedValue

Returns
AlignedValue

Throws
If the leaf is not in the tree

pathForLeaf()
Internal

pathForLeaf(index, leaf): AlignedValue

Internal implementation of the path construction primitive

Parameters
• index: bigint

• leaf: AlignedValue

Returns
AlignedValue

Throws
If the index is out-of-bounds for the tree

root()
Internal

root(): Value

Internal implementation of the merkle tree root primitive

Returns
Value

toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

update()
update(index, leaf): StateBoundedMerkleTree

Inserts a value into the Merkle tree, returning the updated tree

Parameters
• index: bigint

• leaf: AlignedValue

Returns
StateBoundedMerkleTree

Throws
If the index is out-of-bounds for the tree

Class: StateMap
Represents a key-value map, where keys are AlignedValues, and values are StateValues.

Constructors
new StateMap()
new StateMap(): StateMap

Returns
StateMap

Methods
get()
get(key): undefined | StateValue

Parameters
• key: AlignedValue

Returns
undefined | StateValue

insert()
insert(key, value): StateMap

Parameters
• key: AlignedValue

• value: StateValue

Returns
StateMap

keys()
keys(): AlignedValue[]

Returns
AlignedValue[]

remove()
remove(key): StateMap

Parameters
• key: AlignedValue

Returns
StateMap

toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

Class: StateValue
Represents the core of a contract's state, and recursively represents each of its components.

There are different classes of state values:

null
Cells of AlignedValues
Maps from AlignedValues to state values
Bounded Merkle trees containing AlignedValue leaves
Short (<= 15 element) arrays of state values
State values are immutable, any operations that mutate states will return a new state instead.

Constructors
new StateValue()
private new StateValue(): StateValue

Returns
StateValue

Methods
arrayPush()
arrayPush(value): StateValue

Parameters
• value: StateValue

Returns
StateValue

asArray()
asArray(): undefined | StateValue[]

Returns
undefined | StateValue[]

asBoundedMerkleTree()
asBoundedMerkleTree(): undefined | StateBoundedMerkleTree

Returns
undefined | StateBoundedMerkleTree

asCell()
asCell(): AlignedValue

Returns
AlignedValue

asMap()
asMap(): undefined | StateMap

Returns
undefined | StateMap

encode()
Internal

encode(): EncodedStateValue

Returns
EncodedStateValue

logSize()
logSize(): number

Returns
number

toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

type()
type(): 
  | "map"
  | "null"
  | "cell"
  | "array"
  | "boundedMerkleTree"

Returns
| "map" | "null" | "cell" | "array" | "boundedMerkleTree"

decode()
Internal

static decode(value): StateValue

Parameters
• value: EncodedStateValue

Returns
StateValue

newArray()
static newArray(): StateValue

Returns
StateValue

newBoundedMerkleTree()
static newBoundedMerkleTree(tree): StateValue

Parameters
• tree: StateBoundedMerkleTree

Returns
StateValue

newCell()
static newCell(value): StateValue

Parameters
• value: AlignedValue

Returns
StateValue

newMap()
static newMap(map): StateValue

Parameters
• map: StateMap

Returns
StateValue

newNull()
static newNull(): StateValue

Returns
StateValue

Class: VmResults
Represents the results of a VM call

Constructors
new VmResults()
private new VmResults(): VmResults

Returns
VmResults

Properties
events
readonly events: GatherResult[];

The events that got emitted by this VM invocation

gasCost
readonly gasCost: bigint;

The computed gas cost of running this VM invocation

stack
readonly stack: VmStack;

The VM stack at the end of the VM invocation

Methods
toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

Class: VmStack
Represents the state of the VM's stack at a specific point. The stack is an array of StateValues, each of which is also annotated with whether it is "strong" or "weak"; that is, whether it is permitted to be stored on-chain or not.

Constructors
new VmStack()
new VmStack(): VmStack

Returns
VmStack

Methods
get()
get(idx): undefined | StateValue

Parameters
• idx: number

Returns
undefined | StateValue

isStrong()
isStrong(idx): undefined | boolean

Parameters
• idx: number

Returns
undefined | boolean

length()
length(): number

Returns
number

push()
push(value, is_strong): void

Parameters
• value: StateValue

• is_strong: boolean

Returns
void

removeLast()
removeLast(): void

Returns
void

toString()
toString(compact?): string

Parameters
• compact?: boolean

Returns
string

## Enumeration: NetworkId
The network currently being targeted

Enumeration Members
DevNet
DevNet: 1;

A developer network, not guaranteed to be persistent

MainNet
MainNet: 3;

The Midnight mainnet

TestNet
TestNet: 2;

A persistent testnet

Undeployed
Undeployed: 0;

A local test network

## Functions

Function: alignedConcat()
Internal

alignedConcat(...values): AlignedValue

Concatenates multiple ocrt.AlignedValues

Parameters
• ...values: AlignedValue[]

Returns
AlignedValue

Function: assert()
Internal

assert(b, s): void

Compiler internal for assertions

Parameters
• b: boolean

• s: string

Returns
void

Function: bigIntToValue()
Internal

bigIntToValue(x): Value

Internal conversion between bigints and their field-aligned binary representation

Parameters
• x: bigint

Returns
Value

@midnight-ntwrk/compact-runtime v0.7.0 / checkProofData

Function: checkProofData()
checkProofData(zkir, proofData): void

Verifies a given ProofData satisfies the constrains of a ZK circuit descripted by given IR

Parameters
• zkir: string

• proofData: ProofData

Returns
void

Throws
If the circuit is not satisfied

@midnight-ntwrk/compact-runtime v0.7.0 / coinCommitment

Function: coinCommitment()
Internal

coinCommitment(coin, recipient): AlignedValue

Internal implementation of the coin commitment primitive.

Parameters
• coin: AlignedValue

• recipient: AlignedValue

Returns
AlignedValue

@midnight-ntwrk/compact-runtime v0.7.0 / constructorContext

Function: constructorContext()
constructorContext<T>(initialPrivateState, coinPublicKey): ConstructorContext<T>

Creates a new ConstructorContext with the given initial private state and an empty Zswap local state.

Type parameters
• T

Parameters
• initialPrivateState: T

The private state to use to execute the contract's constructor.

• coinPublicKey: string

The Zswap coin public key of the user executing the contract.

Returns
ConstructorContext<T>

@midnight-ntwrk/compact-runtime v0.7.0 / contractDependencies

Function: contractDependencies()
contractDependencies(contractReferenceLocations, state): string[]

Given a StateValue representing the current ledger state of a contract, uses the ContractReferenceLocations object produced by the Compact compiler to extract the current contract addresses present in the given ledger state. The produced contract addresses represent the contracts on which the root contract depends. The dependencies are used in a multi-contract setting to fetch the ledger states of all contracts on which the root contract depends prior to execution.

NOTE: The given ContractReferenceLocations must be from the contract executable containing the ledger state constructor that produced the given StateValue.

Parameters
• contractReferenceLocations: ContractReferenceLocations

A data structure pointing to contract references in the ledger state of the root contract.

• state: StateValue

The current ledger state of the root contract.

Returns
string[]

A list of all contract addresses (references) present in the given ledger state.

Remarks
The algorithm has three main stages:

It unwraps the PublicLedgerSegments in the given ContractReferenceLocations until a SparseCompactADT is reached. Each time a PublicLedgerSegments is unwrapped, it casts the current state value to a state value array and proceeds recursively with each of the state values and unwrapped ledger segments.
It unwraps each SparseCompactADT in the current PublicLedgerSegments until a SparseCompactType is reached. Each time a SparseCompactADT is unwrapped, it casts the current state value to a state representation indicated by the SparseCompactADT.
Once the current state can no longer be reduced, it must represent a Compact contract address somewhere inside the state, and that contract address is added to the dependency set.

@midnight-ntwrk/compact-runtime v0.7.0 / convert_Uint8Array_to_bigint

Function: convert_Uint8Array_to_bigint()
Internal

convert_Uint8Array_to_bigint(n, a): bigint

Compiler internal for typecasts

Parameters
• n: number

• a: Uint8Array

Returns
bigint

@midnight-ntwrk/compact-runtime v0.7.0 / convert_bigint_to_Uint8Array

Function: convert_bigint_to_Uint8Array()
Internal

convert_bigint_to_Uint8Array(n, x): Uint8Array

Compiler internal for typecasts

Parameters
• n: number

• x: bigint

Returns
Uint8Array

@midnight-ntwrk/compact-runtime v0.7.0 / createZswapInput

Function: createZswapInput()
createZswapInput(circuitContext, qualifiedCoinInfo): void

Adds a coin to the list of inputs consumed by the circuit.

Parameters
• circuitContext: CircuitContext<unknown>

The current circuit context.

• qualifiedCoinInfo: EncodedQualifiedCoinInfo

The input to consume.

Returns
void

@midnight-ntwrk/compact-runtime v0.7.0 / createZswapOutput

Function: createZswapOutput()
createZswapOutput(
   circuitContext, 
   coinInfo, 
   recipient): void

Adds a coin to the list of outputs produced by the circuit.

Parameters
• circuitContext: CircuitContext<unknown>

The current circuit context.

• coinInfo: EncodedCoinInfo

The coin to produce.

• recipient: EncodedRecipient

The coin recipient - either a coin public key representing an end user or a contract address representing a contract.

Returns
void

@midnight-ntwrk/compact-runtime v0.7.0 / decodeCoinInfo

Function: decodeCoinInfo()
decodeCoinInfo(coin): CoinInfo

Decode a CoinInfo from Compact's CoinInfo TypeScript representation

Parameters
• coin

• coin.color: Uint8Array

• coin.nonce: Uint8Array

• coin.value: bigint

Returns
CoinInfo

@midnight-ntwrk/compact-runtime v0.7.0 / decodeCoinPublicKey

Function: decodeCoinPublicKey()
decodeCoinPublicKey(pk): CoinPublicKey

Decode a CoinPublicKey from a Uint8Array originating from Compact's CoinPublicKey type

Parameters
• pk: Uint8Array

Returns
CoinPublicKey

@midnight-ntwrk/compact-runtime v0.7.0 / decodeContractAddress

Function: decodeContractAddress()
decodeContractAddress(addr): ContractAddress

Decode a ContractAddress from a Uint8Array originating from Compact's ContractAddress type

Parameters
• addr: Uint8Array

Returns
ContractAddress

@midnight-ntwrk/compact-runtime v0.7.0 / decodeQualifiedCoinInfo

Function: decodeQualifiedCoinInfo()
decodeQualifiedCoinInfo(coin): QualifiedCoinInfo

Decode a QualifiedCoinInfo from Compact's QualifiedCoinInfo TypeScript representation

Parameters
• coin

• coin.color: Uint8Array

• coin.mt_index: bigint

• coin.nonce: Uint8Array

• coin.value: bigint

Returns
QualifiedCoinInfo

@midnight-ntwrk/compact-runtime v0.7.0 / decodeRecipient

Function: decodeRecipient()
decodeRecipient(__namedParameters): Recipient

Converts an EncodedRecipient to a Recipient.

Parameters
• __namedParameters: EncodedRecipient

Returns
Recipient

@midnight-ntwrk/compact-runtime v0.7.0 / decodeTokenType

Function: decodeTokenType()
decodeTokenType(tt): TokenType

Decode a TokenType from a Uint8Array originating from Compact's TokenType type

Parameters
• tt: Uint8Array

Returns
TokenType

@midnight-ntwrk/compact-runtime v0.7.0 / decodeZswapLocalState

Function: decodeZswapLocalState()
decodeZswapLocalState(state): ZswapLocalState

Converts an EncodedZswapLocalState to a ZswapLocalState. Used when we need to use data from contract execution to construct transactions.

Parameters
• state: EncodedZswapLocalState

The encoded Zswap local state.

Returns
ZswapLocalState

@midnight-ntwrk/compact-runtime v0.7.0 / degradeToTransient

Function: degradeToTransient()
degradeToTransient(x): bigint

The Compact builtin degrade_to_transient function

This function "degrades" the output of a persistentHash or persistentCommit to a field element, which can then be used in transientHash or transientCommit.

Parameters
• x: Uint8Array

Returns
bigint

Throws
If x is not 32 bytes long

@midnight-ntwrk/compact-runtime v0.7.0 / dummyContractAddress

Function: dummyContractAddress()
dummyContractAddress(): string

A sample contract address, guaranteed to be the same for a given network ID for use in testing

Returns
string

@midnight-ntwrk/compact-runtime v0.7.0 / ecAdd

Function: ecAdd()
ecAdd(a, b): CurvePoint

The Compact builtin ec_add function

This function add two elliptic curve points (in multiplicative notation)

Parameters
• a: CurvePoint

• b: CurvePoint

Returns
CurvePoint

@midnight-ntwrk/compact-runtime v0.7.0 / ecMul

Function: ecMul()
ecMul(a, b): CurvePoint

The Compact builtin ec_mul function

This function multiplies an elliptic curve point by a scalar (in multiplicative notation)

Parameters
• a: CurvePoint

• b: bigint

Returns
CurvePoint

@midnight-ntwrk/compact-runtime v0.7.0 / ecMulGenerator

Function: ecMulGenerator()
ecMulGenerator(b): CurvePoint

The Compact builtin ec_mul_generator function

This function multiplies the primary group generator of the embedded curve by a scalar (in multiplicative notation)

Parameters
• b: bigint

Returns
CurvePoint

@midnight-ntwrk/compact-runtime v0.7.0 / emptyZswapLocalState

Function: emptyZswapLocalState()
emptyZswapLocalState(coinPublicKey): EncodedZswapLocalState

Constructs a new EncodedZswapLocalState with the given coin public key. The result can be used to create a ConstructorContext.

Parameters
• coinPublicKey: string

The Zswap coin public key of the user executing the circuit.

Returns
EncodedZswapLocalState

@midnight-ntwrk/compact-runtime v0.7.0 / encodeCoinInfo

Function: encodeCoinInfo()
encodeCoinInfo(coin): {
  color: Uint8Array;
  nonce: Uint8Array;
  value: bigint;
}

Encode a CoinInfo into a Compact's CoinInfo TypeScript representation

Parameters
• coin: CoinInfo

Returns
{
  color: Uint8Array;
  nonce: Uint8Array;
  value: bigint;
}

color
color: Uint8Array;

nonce
nonce: Uint8Array;

value
value: bigint;

@midnight-ntwrk/compact-runtime v0.7.0 / encodeCoinPublicKey

Function: encodeCoinPublicKey()
encodeCoinPublicKey(pk): Uint8Array

Encode a CoinPublicKey into a Uint8Array for use in Compact's CoinPublicKey type

Parameters
• pk: string

Returns
Uint8Array

@midnight-ntwrk/compact-runtime v0.7.0 / encodeContractAddress

Function: encodeContractAddress()
encodeContractAddress(addr): Uint8Array

Encode a ContractAddress into a Uint8Array for use in Compact's ContractAddress type

Parameters
• addr: string

Returns
Uint8Array

@midnight-ntwrk/compact-runtime v0.7.0 / encodeQualifiedCoinInfo

Function: encodeQualifiedCoinInfo()
encodeQualifiedCoinInfo(coin): {
  color: Uint8Array;
  mt_index: bigint;
  nonce: Uint8Array;
  value: bigint;
}

Encode a QualifiedCoinInfo into a Compact's QualifiedCoinInfo TypeScript representation

Parameters
• coin: QualifiedCoinInfo

Returns
{
  color: Uint8Array;
  mt_index: bigint;
  nonce: Uint8Array;
  value: bigint;
}

color
color: Uint8Array;

mt_index
mt_index: bigint;

nonce
nonce: Uint8Array;

value
value: bigint;

@midnight-ntwrk/compact-runtime v0.7.0 / encodeRecipient

Function: encodeRecipient()
encodeRecipient(__namedParameters): EncodedRecipient

Converts an Recipient to an EncodedRecipient. Useful for testing.

Parameters
• __namedParameters: Recipient

Returns
EncodedRecipient

@midnight-ntwrk/compact-runtime v0.7.0 / encodeTokenType

Function: encodeTokenType()
encodeTokenType(tt): Uint8Array

Encode a TokenType into a Uint8Array for use in Compact's TokenType type

Parameters
• tt: string

Returns
Uint8Array

@midnight-ntwrk/compact-runtime v0.7.0 / encodeZswapLocalState

Function: encodeZswapLocalState()
encodeZswapLocalState(state): EncodedZswapLocalState

Converts a ZswapLocalState to an EncodedZswapLocalState. Useful for testing.

Parameters
• state: ZswapLocalState

The decoded Zswap local state.

Returns
EncodedZswapLocalState

@midnight-ntwrk/compact-runtime v0.7.0 / hashToCurve

Function: hashToCurve()
hashToCurve<a>(rt_type, x): CurvePoint

The Compact builtin hash_to_curve function

This function maps arbitrary values representable in Compact to elliptic curve points in the proof system's embedded curve.

Outputs are guaranteed to have unknown discrete logarithm with respect to the group base, and any other output, but are not guaranteed to be unique (a given input can be proven correct for multiple outputs).

Inputs of different types may have the same output, if they have the same field-aligned binary representation.

Type parameters
• a

Parameters
• rt_type: CompactType<a>

• x: a

Returns
CurvePoint

@midnight-ntwrk/compact-runtime v0.7.0 / leafHash

Function: leafHash()
Internal

leafHash(value): AlignedValue

Internal implementation of the Merkle tree leaf hash primitive.

Parameters
• value: AlignedValue

Returns
AlignedValue

@midnight-ntwrk/compact-runtime v0.7.0 / maxAlignedSize

Function: maxAlignedSize()
Internal

maxAlignedSize(alignment): bigint

Internal implementation of the max aligned size primitive.

Parameters
• alignment: Alignment

Returns
bigint

@midnight-ntwrk/compact-runtime v0.7.0 / ownPublicKey

Function: ownPublicKey()
ownPublicKey(circuitContext): EncodedCoinPublicKey

Retrieves the Zswap coin public key of the user executing the circuit.

Parameters
• circuitContext: CircuitContext<unknown>

The current circuit context.

Returns
EncodedCoinPublicKey

@midnight-ntwrk/compact-runtime v0.7.0 / persistentCommit

Function: persistentCommit()
persistentCommit<a>(
   rt_type, 
   value, 
   opening): Uint8Array

The Compact builtin persistent_commit function

This function is a non-circuit-optimised commitment function from arbitrary values representable in Compact, and a 256-bit bytestring opening, to a 256-bit bytestring. It is guaranteed to persist between upgrades. It should be used to derive state data, and not for consistency checks where avoidable.

Note that data containing Opaque elements may throw runtime errors, and cannot be relied upon as a consistent representation.

Type parameters
• a

Parameters
• rt_type: CompactType<a>

• value: a

• opening: Uint8Array

Returns
Uint8Array

Throws
If rt_type encodes a type containing Compact 'Opaque' types, or opening is not 32 bytes long

@midnight-ntwrk/compact-runtime v0.7.0 / persistentHash

Function: persistentHash()
persistentHash<a>(rt_type, value): Uint8Array

The Compact builtin persistent_hash function

This function is a non-circuit-optimised hash function for mostly arbitrary data. It is guaranteed to persist between upgrades, with the exception of devnet. It should be used to derive state data, and not for consistency checks where avoidable.

Note that data containing Opaque elements may throw runtime errors, and cannot be relied upon as a consistent representation.

Type parameters
• a

Parameters
• rt_type: CompactType<a>

• value: a

Returns
Uint8Array

Throws
If rt_type encodes a type containing Compact 'Opaque' types

@midnight-ntwrk/compact-runtime v0.7.0 / runProgram

Function: runProgram()
runProgram(
   initial, 
   ops, 
   cost_model, 
   gas_limit?): VmResults

Runs a VM program against an initial stack, with an optional gas limit

Parameters
• initial: VmStack

• ops: Op<null>[]

• cost_model: CostModel

• gas_limit?: bigint

Returns
VmResults

@midnight-ntwrk/compact-runtime v0.7.0 / sampleContractAddress

Function: sampleContractAddress()
sampleContractAddress(): ContractAddress

Samples a uniform contract address, for use in testing

Returns
ContractAddress

@midnight-ntwrk/compact-runtime v0.7.0 / sampleSigningKey

Function: sampleSigningKey()
sampleSigningKey(): SigningKey

Randomly samples a SigningKey.

Returns
SigningKey

@midnight-ntwrk/compact-runtime v0.7.0 / sampleTokenType

Function: sampleTokenType()
sampleTokenType(): TokenType

Samples a uniform token type, for use in testing

Returns
TokenType

@midnight-ntwrk/compact-runtime v0.7.0 / signData

Function: signData()
signData(key, data): Signature

Signs arbitrary data with the given signing key.

WARNING: Do not expose access to this function for valuable keys for data that is not strictly controlled!

Parameters
• key: string

• data: Uint8Array

Returns
Signature

@midnight-ntwrk/compact-runtime v0.7.0 / signatureVerifyingKey

Function: signatureVerifyingKey()
signatureVerifyingKey(sk): SignatureVerifyingKey

Returns the verifying key for a given signing key

Parameters
• sk: string

Returns
SignatureVerifyingKey

@midnight-ntwrk/compact-runtime v0.7.0 / tokenType

Function: tokenType()
tokenType(domain_sep, contract): TokenType

Derives the TokenType associated with a particular DomainSeperator and contract.

Parameters
• domain_sep: Uint8Array

• contract: string

Returns
TokenType

@midnight-ntwrk/compact-runtime v0.7.0 / transientCommit

Function: transientCommit()
transientCommit<a>(
   rt_type, 
   value, 
   opening): bigint

The Compact builtin transient_commit function

This function is a circuit-efficient commitment function from arbitrary values representable in Compact, and a field element commitment opening, to field elements, which is not guaranteed to persist between upgrades. It should not be used to derive state data, but can be used for consistency checks.

Type parameters
• a

Parameters
• rt_type: CompactType<a>

• value: a

• opening: bigint

Returns
bigint

Throws
If opening is out of range for field elements

@midnight-ntwrk/compact-runtime v0.7.0 / transientHash

Function: transientHash()
transientHash<a>(rt_type, value): bigint

The Compact builtin transient_hash function

This function is a circuit-efficient compression function from arbitrary data to field elements, which is not guaranteed to persist between upgrades. It should not be used to derive state data, but can be used for consistency checks.

Type parameters
• a

Parameters
• rt_type: CompactType<a>

• value: a

Returns
bigint

@midnight-ntwrk/compact-runtime v0.7.0 / type_error

Function: type_error()
Internal

type_error(
   who, 
   what, 
   where, 
   type, 
   x): never

Compiler internal for type errors

Parameters
• who: string

• what: string

• where: string

• type: string

• x: any

Returns
never

@midnight-ntwrk/compact-runtime v0.7.0 / upgradeFromTransient

Function: upgradeFromTransient()
upgradeFromTransient(x): Uint8Array

The Compact builtin upgrade_from_transient function

This function "upgrades" the output of a transientHash or transientCommit to 256-bit byte string, which can then be used in persistentHash or persistentCommit.

Parameters
• x: bigint

Returns
Uint8Array

Throws
If x is not a valid field element

@midnight-ntwrk/compact-runtime v0.7.0 / valueToBigInt

Function: valueToBigInt()
Internal

valueToBigInt(x): bigint

Internal conversion between field-aligned binary values and bigints within the scalar field

Parameters
• x: Value

Returns
bigint

Throws
If the value does not encode a field element

@midnight-ntwrk/compact-runtime v0.7.0 / verifySignature

Function: verifySignature()
verifySignature(
   vk, 
   data, 
   signature): boolean

Verifies if a signature is correct

Parameters
• vk: string

• data: Uint8Array

• signature: string

Returns
boolean

@midnight-ntwrk/compact-runtime v0.7.0 / witnessContext

Function: witnessContext()
Internal

witnessContext<L, T>(
   ledger, 
   privateState, 
contractAddress): WitnessContext<L, T>

Internal constructor for WitnessContext.

Type parameters
• L

• T

Parameters
• ledger: L

• privateState: T

• contractAddress: string

Returns
WitnessContext<L, T>

## Globals 

@midnight-ntwrk/compact-runtime v0.7.0
Enumerations
NetworkId
Classes
CompactError
CompactTypeBoolean
CompactTypeBytes
CompactTypeCurvePoint
CompactTypeEnum
CompactTypeField
CompactTypeMerkleTreeDigest
CompactTypeMerkleTreePath
CompactTypeMerkleTreePathEntry
CompactTypeOpaqueString
CompactTypeOpaqueUint8Array
CompactTypeUnsignedInteger
CompactTypeVector
ContractMaintenanceAuthority
ContractOperation
ContractState
CostModel
QueryContext
QueryResults
StateBoundedMerkleTree
StateMap
StateValue
VmResults
VmStack
Interfaces
CircuitContext
CircuitResults
CompactType
ConstructorContext
ConstructorResult
CurvePoint
EncodedCoinInfo
EncodedCoinPublicKey
EncodedContractAddress
EncodedQualifiedCoinInfo
EncodedRecipient
EncodedZswapLocalState
MerkleTreeDigest
MerkleTreePath
MerkleTreePathEntry
ProofData
Recipient
WitnessContext
ZswapLocalState
Type Aliases
AlignedValue
Alignment
AlignmentAtom
AlignmentSegment
BlockContext
CoinCommitment
CoinInfo
CoinPublicKey
ContractAddress
ContractReferenceLocations
DomainSeperator
Effects
Fr
GatherResult
Key
Nonce
Nullifier
Op
QualifiedCoinInfo
Signature
SignatureVerifyingKey
SigningKey
SparseCompactADT
SparseCompactArrayLikeADT
SparseCompactCellADT
SparseCompactContractAddress
SparseCompactListADT
SparseCompactMapADT
SparseCompactSetADT
SparseCompactStruct
SparseCompactType
SparseCompactValue
SparseCompactVector
TokenType
Transcript
Value
Variables
DUMMY_ADDRESS
MAX_FIELD
versionString
Functions
alignedConcat
assert
bigIntToValue
checkProofData
coinCommitment
constructorContext
contractDependencies
convert_Uint8Array_to_bigint
convert_bigint_to_Uint8Array
createZswapInput
createZswapOutput
decodeCoinInfo
decodeCoinPublicKey
decodeContractAddress
decodeQualifiedCoinInfo
decodeRecipient
decodeTokenType
decodeZswapLocalState
degradeToTransient
dummyContractAddress
ecAdd
ecMul
ecMulGenerator
emptyZswapLocalState
encodeCoinInfo
encodeCoinPublicKey
encodeContractAddress
encodeQualifiedCoinInfo
encodeRecipient
encodeTokenType
encodeZswapLocalState
hashToCurve
leafHash
maxAlignedSize
ownPublicKey
persistentCommit
persistentHash
runProgram
sampleContractAddress
sampleSigningKey
sampleTokenType
signData
signatureVerifyingKey
tokenType
transientCommit
transientHash
type_error
upgradeFromTransient
valueToBigInt
verifySignature
witnessContext

## Interfaces

@midnight-ntwrk/compact-runtime v0.7.0 / CircuitContext

Interface: CircuitContext<T>
The external information accessible from within a Compact circuit call

Type parameters
• T

Properties
currentPrivateState
currentPrivateState: T;

The current private state for the contract.

currentZswapLocalState
currentZswapLocalState: EncodedZswapLocalState;

The current Zswap local state. Tracks inputs and outputs produced during circuit execution.

originalState
originalState: ContractState;

The original contract state the circuit call was started at.

transactionContext
transactionContext: QueryContext;

The current on-chain context the transaction is evolving.

Previous
globals


@midnight-ntwrk/compact-runtime v0.7.0 / CircuitResults

Interface: CircuitResults<T, U>
The results of the call to a Compact circuit

Type parameters
• T

• U

Properties
context
context: CircuitContext<T>;

The updated context after the circuit execution, that can be used to inform further runs

proofData
proofData: ProofData;

The data required to prove this circuit run

result
result: U;

The primary result, as returned from Compact

@midnight-ntwrk/compact-runtime v0.7.0 / CompactType

Interface: CompactType<a>
A runtime representation of a type in Compact

Type parameters
• a

Methods
alignment()
alignment(): Alignment

The field-aligned binary alignment of this type.

Returns
Alignment

fromValue()
fromValue(value): a

Converts this type's field-aligned binary representation to its TypeScript representation destructively; (partially) consuming the input, and ignoring superflous data for chaining.

Parameters
• value: Value

Returns
a

toValue()
toValue(value): Value

Converts this type's TypeScript representation to its field-aligned binary representation

Parameters
• value: a

Returns
Value


@midnight-ntwrk/compact-runtime v0.7.0 / ConstructorContext

Interface: ConstructorContext<T>
Passed to the constructor of a contract. Used to compute the contract's initial ledger state.

Type parameters
• T

Properties
initialPrivateState
initialPrivateState: T;

The private state we would like to use to execute the contract's constructor.

initialZswapLocalState
initialZswapLocalState: EncodedZswapLocalState;

An initial (usually empty) Zswap local state to use to execute the contract's constructor.

@midnight-ntwrk/compact-runtime v0.7.0 / ConstructorResult

Interface: ConstructorResult<T>
The result of executing a contract constructor.

Type parameters
• T

Properties
currentContractState
currentContractState: ContractState;

The contract's initial ledger (public state).

currentPrivateState
currentPrivateState: T;

The contract's initial private state. Potentially different from the private state passed in ConstructorContext.

currentZswapLocalState
currentZswapLocalState: EncodedZswapLocalState;

The contract's initial Zswap local state. Potentially includes outputs created in the contract's constructor.

@midnight-ntwrk/compact-runtime v0.7.0 / CurvePoint

Interface: CurvePoint
A point in the embedded elliptic curve. TypeScript representation of the Compact type of the same name

Properties
x
readonly x: bigint;

y
readonly y: bigint;

There is still documentation on these if needed:
EncodedCoinInfo
EncodedCoinPublicKey
EncodedContractAddress
EncodedQualifiedCoinInfo
EncodedRecipient
EncodedZswapLocalState
MerkleTreeDigest
MerkleTreePath
MerkleTreePathEntry
ProofData
Recipient
WitnessContext
ZswapLocalState

## Type Aliases (ask if you need the documentation)

## Variables 

@midnight-ntwrk/compact-runtime v0.7.0 / DUMMY_ADDRESS

Variable: DUMMY_ADDRESS
const DUMMY_ADDRESS: string;

A valid placeholder contract address

Deprecated
Cannot handle ocrt.NetworkIds, use ocrt.dummyContractAddress instead.


@midnight-ntwrk/compact-runtime v0.7.0 / MAX_FIELD

Variable: MAX_FIELD
const MAX_FIELD: bigint;

The maximum value representable in Compact's Field type

One less than the prime modulus of the proof system's scalar field


@midnight-ntwrk/compact-runtime v0.7.0 / versionString

Variable: versionString
const versionString: string = "0.7.0";

